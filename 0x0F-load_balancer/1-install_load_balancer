#!/usr/bin/env bash
# script to install loadbalancer with provided configurations


configurations="
frontend haProxy
    bind *:80
    mode http
    default back_end haproxyBackend
    
backend haProxyBackend
    balance roundrobin
    mode http 
    option forwardfor
    server 4364-web-01 54.90.249.226:80 check
    server 4364-web-02 54.211.125.140:80 check
"
sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get install -y haproxy
echo "ENABLED=1" >> /etc/default/haproxy
sudo sh -c "printf '%s' '$configurations' >> /etc/haproxy/haproxy.cfg"
sudo service haproxy start
